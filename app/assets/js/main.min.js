import*as THREE from"../../three.js/build/three.module.js";import{Sky}from"../../three.js/scene/jsm/objects/Sky.js";import{VignetteShader}from"../../three.js/scene/jsm/shaders/VignetteShader.js";import{ShaderPass}from"../../three.js/scene/jsm/postprocessing/ShaderPass.js";import{EffectComposer}from"../../three.js/scene/jsm/postprocessing/EffectComposer.js";import{RenderPass}from"../../three.js/scene/jsm/postprocessing/RenderPass.js";import{GlitchPass}from"../../three.js/scene/jsm/postprocessing/GlitchPass.js";let camera,scene,renderer,mixer,clock,composerScene,composer,sky,sun,glitchPass,x=0,s=.4965;const delta=.01;init(),render(),animate();var nav=document.getElementById("nav"),navlinks=nav.getElementsByTagName("a");function toggleNav(){nav.classList.contains("active")?nav.classList.remove("active"):nav.classList.add("active")}document.getElementById("nav-icon").addEventListener("click",(function(e){e.preventDefault(),toggleNav()}));for(var i=0;i<navlinks.length;i++)navlinks[i].addEventListener("click",(function(){toggleNav()}));function initSky(){sky=new Sky,sky.scale.setScalar(45e4),scene.add(sky),sun=new THREE.Vector3;const e={turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.7,inclination:.4965,azimuth:.25,exposure:renderer.toneMappingExposure};!function(){const n=sky.material.uniforms;n.turbidity.value=e.turbidity,n.rayleigh.value=e.rayleigh,n.mieCoefficient.value=e.mieCoefficient,n.mieDirectionalG.value=e.mieDirectionalG;const i=Math.PI*(e.inclination-.5),t=2*Math.PI*(e.azimuth-.5);sun.x=Math.cos(t),sun.y=Math.sin(t)*Math.sin(i),sun.z=Math.sin(t)*Math.cos(i),n.sunPosition.value.copy(sun),renderer.toneMappingExposure=e.exposure,renderer.render(scene,camera)}()}function moveSun(e,n){const i=sky.material.uniforms,t=Math.PI*(e-.5),s=2*Math.PI*(n-.5);sun.x=Math.cos(s),sun.y=Math.sin(s)*Math.sin(t),sun.z=Math.sin(s)*Math.cos(t),i.sunPosition.value.copy(sun)}function init(){camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,100),camera.position.set(0,0,0),camera.rotation.x=0,camera.rotation.y=-.5,camera.rotation.z=0,clock=new THREE.Clock,scene=new THREE.Scene;const e=new ShaderPass(VignetteShader);e.uniforms.offset.value=.95,e.uniforms.darkness.value=1.6;const n={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!0};renderer=new THREE.WebGLRenderer,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),renderer.outputEncoding=THREE.sRGBEncoding,renderer.toneMapping=THREE.ACESFilmicToneMapping,renderer.toneMappingExposure=.39,document.body.appendChild(renderer.domElement),composer=new EffectComposer(renderer,new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,n)),composer.addPass(new RenderPass(scene,camera)),composer.addPass(e),glitchPass=new GlitchPass,composer.addPass(glitchPass),scene.add(new THREE.HemisphereLight(16777215,0,.8));const i=new THREE.DirectionalLight(16777215,2);i.position.set(0,0,8),scene.add(i),initSky(),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),composer.setSize(window.innerWidth,window.innerHeight),render()}function render(){composer.render(.01)}function animate(){requestAnimationFrame(animate),render()}function highlight(){var e=$(window).scrollTop(),n=$(window).height();$("#content ul, #content p").each((function(){var i=$(this).offset().top;e+n>=i+window.innerHeight/3?$(this).addClass("text-active"):$(this).removeClass("text-active")}))}window.addEventListener("scroll",(e=>{camera.rotation.z=0,camera.rotation.x=.1*window.pageYOffset/14*Math.PI/180,camera.rotation.y=(window.pageYOffset-400)/14*Math.PI/180,moveSun(.4965-window.pageYOffset/102400,.25),highlight()}));
